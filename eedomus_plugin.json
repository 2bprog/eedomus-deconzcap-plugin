{
	"plugin_id": "bbdeconzcap",
	"name_fr": "deConz Capteurs",
	"icon": "deconzcap.png",
	"version": "0.0.3",
	"creation_date": "2019-12-23",
	"modification_date": "2019-12-26",
	"author": "Benjamin B. (benj70b)",
	"description_fr": "Créer un périphérique deConz de type capteur",
	"description_en": "",
	"description_es": "",
	"description_it": "",
	"description_de": "",
	"forum_link": "",
	"parameters": [
	    {
			"parameter": "DZCONFIG",
			"description": "<b>Configuration :</b>",
            "xtype": "displayfield",
			"field": "style: 'padding: 3px; visibility:hidden;', value: 'dmFyIHhodHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CnhodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PSA0ICYmIHRoaXMuc3RhdHVzID09IDIwMCkgewogICAgICAgIHZhciBteU9iaiA9IEpTT04ucGFyc2UodGhpcy5yZXNwb25zZVRleHQpOwogICAgICAgIGlmIChteU9iai5sZW5ndGggPiAwKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVyaXBoX3BhcmFtW2BEWklQYF0nKS52YWx1ZSA9IG15T2JqWzBdLmludGVybmFsaXBhZGRyZXNzICsgJzonICsgbXlPYmpbMF0uaW50ZXJuYWxwb3J0OwogICAgfQp9CnhodHRwLm9wZW4oJ0dFVCcsICdodHRwczovL3NlY3VyZS5lZWRvbXVzLmNvbS9zY3JpcHRfcHJveHkvP2V4ZWM9MkJfZGVjb256bGlzdC5waHAmY21kPWRpc2NvdmVyJnAyPWpzb24nLCB0cnVlKTsKeGh0dHAuc2VuZCgpOw=='"
		},
				
		
		{ 
			"parameter": "DZIP",
			"description": "IP + Port serveur deCONZ <a href=\\'javascript:eval(window.atob(document.getElementById(&quot;periph_param[`DZCONFIG`]&quot;).innerHTML)));\\'><img src=\\'/img/Search.png\\' width=\\'16\\' align=\\'absmiddle\\'></a>",
			"xtype": "textfield",
			"default_value": "10.66.254.101:8090",
			"testb64" : "dmFyIHhodHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CnhodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PSA0ICYmIHRoaXMuc3RhdHVzID09IDIwMCkgewogICAgICAgIHZhciBteU9iaiA9IEpTT04ucGFyc2UodGhpcy5yZXNwb25zZVRleHQpOwogICAgICAgIGlmIChteU9iai5sZW5ndGggPiAwKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVyaXBoX3BhcmFtW2BEWklQYF0nKS52YWx1ZSA9IG15T2JqWzBdLmludGVybmFsaXBhZGRyZXNzICsgJzonICsgbXlPYmpbMF0uaW50ZXJuYWxwb3J0OwogICAgfQp9CnhodHRwLm9wZW4oJ0dFVCcsICdodHRwczovL3NlY3VyZS5lZWRvbXVzLmNvbS9zY3JpcHRfcHJveHkvP2V4ZWM9MkJfZGVjb256bGlzdC5waHAmY21kPWRpc2NvdmVyJnAyPWpzb24nLCB0cnVlKTsKeGh0dHAuc2VuZCgpOw==",
			"field": "width:130, allowBlank:false, maskRe:/[0-9.:]/, regex:/^(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])\\:([0-9]{2}[0-9]?[0-9]?)$/, regexText:'Adresse IP invalide [0-255].[0-255].[0-255]:[0-255]'"			
		},
		{
			"parameter": "DZAPIKEY",
			"description": "Clef API du serveur deConz",
			"xtype": "textfield",
			"default_value": "FB5A4E6BBF",
			"field": "width:130, allowBlank: false , maxLength:40, minLength:10"
		},

		{
			"parameter": "DZIDDECONZ",
			"description": "Identifiant deConz (sensors)",
			"xtype": "numberfield",
			"default_value": "",
			"field": "minValue:1, allowDecimals:false, width:60, allowBlank:false"
		},
		{
			"parameter": "DZACC",
			"description": "<b>Type de capteur :</b>",
			"xtype": "checkbox",
			"field": "style: 'margin-top: 6px; visibility:hidden;', checked: true"
		},
		{
			"parameter": "DZTEMP",
			"description": "Température",
			"xtype": "checkbox",
			"field": "style: 'margin-top: 6px;', checked: true"
		},
		{
			"parameter": "DZHUM",
			"description": "Humidité",
			"xtype": "checkbox",
			"field": "style: 'margin-top: 6px;', checked: false"
		},
		{
			"parameter": "DZPRESSION",
			"description": "Pression",
			"xtype": "checkbox",
			"field": "style: 'margin-top: 6px;', checked: false"
		},
		{
			"parameter": "DZLUX",
			"description": "Luminosité",
			"xtype": "checkbox",
			"field": "style: 'margin-top: 6px;', checked: false"
		},		
		{
			"parameter": "DZMVT",
			"description": "Détecteur de mouvement",
			"xtype": "checkbox",
			"field": "style: 'margin-top: 6px;', checked: false"
		},
		{
			"parameter": "DZOUV",
			"description": "Détecteur d'ouverture",
			"xtype": "checkbox",
			"field": "style: 'margin-top: 6px;', checked: false"
		},
		{
			"parameter": "DZTEL",
			"description": "Télécommande",
			"xtype": "checkbox",
			"field": "style: 'margin-top: 6px;', checked: false"
		},
        {
			"parameter": "DZOPTIONS",
			"description": "<b>Options :</b>",
            "xtype": "displayfield",
			"field": "style: 'padding: 3px;', value: ' '"
		},			
		{
			"parameter": "DZBAT",
			"description": "Indicateur Batterie",
			"xtype": "checkbox",
			"field": "style: 'margin-top: 6px;', checked: true"
		},			
		{
			"parameter": "DZFREQ",
			"description": "Fréquence d'actualisation (min)",
			"xtype": "numberfield",
			"default_value": "10",
			"field": "minValue:0, maxValue:1000 ,allowDecimals:false, width:60, allowBlank:false"
		}
	],
	"scripts": [{
			"name": "2B_deconzlist.php"
		},
		{
			"name": "2B_deconz.php"
		}
	],
	"devices": [
		 {
			"device_id": "deczacc",
			"create": "plugin.parameters.DZACC",
			"module_id": "51",
			"type": "http",
			"name_fr": "Capteur (plugin.parameters.DZIDDECONZ)",
			"icon": "heartbeat.png",
			"utilisation_id": "35",
			"parameters": {
				"VAR1": "2B_deconz.php",
				"VAR2": "plugin.parameters.DZIP,plugin.parameters.DZAPIKEY,sensors,plugin.parameters.DZIDDECONZ",
				"VAR3": "",
				"value_type": "list",
				"ignore_errors": 3,
				"RAW_URL": "http://localhost/script/?exec=[VAR1]&vars=[VAR2]&action=GET",
				"RAW_XPATH": "//reachable",
				"POLLING": "plugin.parameters.DZFREQ",
				"CONVERT": "0"
			},
			"values": [{
					"value": "0",
					"description": "Injoignable",
					"icon": "heartbeat_c2.png"
				},
				{
					"value": "1",
					"description": "OK",
					"icon": "heartbeat_c1.png"
				}
			]
		},
		{
			"device_id": "decztemp",
			"parent_id": "deczacc",
			"create": "plugin.parameters.DZTEMP",
			"module_id": "51",
			"type": "http",
			"name_fr": "Température (plugin.parameters.DZIDDECONZ)",
			"icon": "thermometer.png",
			"utilisation_id": "7",
			"value_unit": "°C",
			"parameters": {
				"VAR1": "2B_deconz.php",
				"VAR2": "plugin.parameters.DZIP,plugin.parameters.DZAPIKEY,sensors,plugin.parameters.DZIDDECONZ",
				"VAR3": "",
				"value_type": "float",
				"ignore_errors": 3,
				"RAW_URL": "http://localhost/script/?exec=[VAR1]&vars=[VAR2]&action=GET",
				"RAW_XPATH": "//temperature div 100",
				"POLLING": "plugin.parameters.DZFREQ",
				"CONVERT": "0"
			}
		},
		{
			"device_id": "deczhum",
			"parent_id": "deczacc",
			"create": "plugin.parameters.DZHUM",
			"module_id": "51",
			"type": "http",
			"name_fr": "Humidité (plugin.parameters.DZIDDECONZ)",
			"icon": "humidite.png",
			"utilisation_id": "22",
			"value_unit": "%",
			"parameters": {
				"VAR1": "2B_deconz.php",
				"VAR2": "plugin.parameters.DZIP,plugin.parameters.DZAPIKEY,sensors,plugin.parameters.DZIDDECONZ",
				"VAR3": "",
				"value_type": "float",
				"ignore_errors": 3,
				"RAW_URL": "http://localhost/script/?exec=[VAR1]&vars=[VAR2]&action=GET",
				"RAW_XPATH": "//humidity div 100",
				"POLLING": "plugin.parameters.DZFREQ",
				"CONVERT": "0"
			}
		},
		{
			"device_id": "deczpression",
			"parent_id": "deczacc",
			"create": "plugin.parameters.DZPRESSION",
			"module_id": "51",
			"type": "http",
			"name_fr": "Pression (plugin.parameters.DZIDDECONZ)",
			"icon": "pression.png",
			"utilisation_id": "32",
			"value_unit": "hPa",
			"parameters": {
				"VAR1": "2B_deconz.php",
				"VAR2": "plugin.parameters.DZIP,plugin.parameters.DZAPIKEY,sensors,plugin.parameters.DZIDDECONZ",
				"VAR3": "",
				"value_type": "float",
				"ignore_errors": 3,
				"RAW_URL": "http://localhost/script/?exec=[VAR1]&vars=[VAR2]&action=GET",
				"RAW_XPATH": "//pressure",
				"POLLING": "plugin.parameters.DZFREQ",
				"CONVERT": "0"
			}
		},
		{
			"device_id": "deczlux",
			"parent_id": "deczacc",
			"create": "plugin.parameters.DZLUX",
			"module_id": "51",
			"type": "http",
			"name_fr": "Luminosité (plugin.parameters.DZIDDECONZ)",
			"icon": "luminosite.png",
			"utilisation_id": "24",
			"value_unit": "Lux",
			"parameters": {
				"VAR1": "2B_deconz.php",
				"VAR2": "plugin.parameters.DZIP,plugin.parameters.DZAPIKEY,sensors,plugin.parameters.DZIDDECONZ",
				"VAR3": "",
				"value_type": "float",
				"ignore_errors": 3,
				"RAW_URL": "http://localhost/script/?exec=[VAR1]&vars=[VAR2]&action=GET",
				"RAW_XPATH": "//lux",
				"POLLING": "plugin.parameters.DZFREQ",
				"CONVERT": "0"
			}
		},
		{
			"device_id": "deczmvt",
			"parent_id": "deczacc",
			"create": "plugin.parameters.DZMVT",
			"module_id": "51",
			"type": "http",
			"name_fr": "Détecteur de mouvement (plugin.parameters.DZIDDECONZ)",
			"icon": "pir.png",
			"utilisation_id": "37",			
			"parameters": {
				"VAR1": "2B_deconz.php",
				"VAR2": "plugin.parameters.DZIP,plugin.parameters.DZAPIKEY,sensors,plugin.parameters.DZIDDECONZ",
				"VAR3": "",
				"value_type": "list",
				"ignore_errors": 3,
				"RAW_URL": "http://localhost/script/?exec=[VAR1]&vars=[VAR2]&action=GET",
				"RAW_XPATH": "//presence",
				"POLLING": "plugin.parameters.DZFREQ",
				"CONVERT": "0"
			},
			"values": [{
					"value": "0",
					"description": "Aucun mouvement",
					"icon": "presenceoff64.png"
				},
				{
					"value": "1",
					"description": "Mouvement",
					"icon": "detection.png"
				}
			]
		},
		{
			"device_id": "deczouv",
			"parent_id": "deczacc",
			"create": "plugin.parameters.DZOUV",
			"module_id": "51",
			"type": "http",
			"name_fr": "Détecteur d'ouverture (plugin.parameters.DZIDDECONZ)",
			"icon": "windows_open.png",
			"utilisation_id": "10",			
			"parameters": {
				"VAR1": "2B_deconz.php",
				"VAR2": "plugin.parameters.DZIP,plugin.parameters.DZAPIKEY,sensors,plugin.parameters.DZIDDECONZ",
				"VAR3": "",
				"value_type": "list",
				"ignore_errors": 3,
				"RAW_URL": "http://localhost/script/?exec=[VAR1]&vars=[VAR2]&action=GET",
				"RAW_XPATH": "//open",
				"POLLING": "plugin.parameters.DZFREQ",
				"CONVERT": "0"
			},
			"values": [{
					"value": "0",
					"description": "Fermé",
					"icon": "windows_closed.png"
				},
				{
					"value": "1",
					"description": "Ouvert",
					"icon": "windows_open.png"
				}
			]
		},

		{
			"device_id": "deczbat",
			"parent_id": "deczacc",
			"create": "plugin.parameters.DZBAT",
			"module_id": "51",
			"type": "http",
			"name_fr": "Niveau de batterie (plugin.parameters.DZIDDECONZ)",
			"icon": "battery.png",
			"utilisation_id": "35",
			"value_unit": "%",
			"parameters": {
				"VAR1": "2B_deconz.php",
				"VAR2": "plugin.parameters.DZIP,plugin.parameters.DZAPIKEY,sensors,plugin.parameters.DZIDDECONZ",
				"VAR3": "",
				"value_type": "float",
				"ignore_errors": 3,
				"RAW_URL": "http://localhost/script/?exec=[VAR1]&vars=[VAR2]&action=GET",
				"RAW_XPATH": "//battery",
				"POLLING": "plugin.parameters.DZFREQ",
				"CONVERT": "0"
			}
		},

		{
			"device_id": "decztel",
			"parent_id": "deczacc",
			"create": "plugin.parameters.DZTEL",
			"module_id": "51",
			"type": "http",
			"name_fr": "Télécommande (plugin.parameters.DZIDDECONZ)",
			"icon": "remote.png",
			"utilisation_id": "35",			
			"parameters": {
				"VAR1": "2B_deconz.php",
				"VAR2": "plugin.parameters.DZIP,plugin.parameters.DZAPIKEY,sensors,plugin.parameters.DZIDDECONZ",
				"VAR3": "",
				"value_type": "list",
				"ignore_errors": 3,
				"RAW_URL": "http://localhost/script/?exec=[VAR1]&vars=[VAR2]&action=GET",
				"RAW_XPATH": "//buttonevent",
				"POLLING": "plugin.parameters.DZFREQ",
				"CONVERT": "0"
			},
			"values": [{
				"value": "0",
				"description": "N/A"				
			}]
		}

	]
}